<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í≤∞Ï†ïÏû•Ïï† Îã§Ìä∏</title>
    
    <!-- Pretendard Ìè∞Ìä∏ -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" rel="stylesheet">
    
    <!-- PWA Î©îÌÉÄ ÌÉúÍ∑∏ -->
    <meta name="description" content="Í≤∞Ï†ïÏû•Ïï† Îã§Ìä∏ - Îã§Ìä∏Î°ú Í≤∞Ï†ïÏùÑ ÎÇ¥Î†§Î≥¥ÏÑ∏Ïöî!">
    <meta name="theme-color" content="#007BFF">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Îã§Ìä∏Í≤åÏûÑ">
    
    <!-- Open Graph / Ïπ¥Ïπ¥Ïò§ÌÜ° Í≥µÏú† ÏµúÏ†ÅÌôî -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Í≤∞Ï†ïÏû•Ïï† Îã§Ìä∏ üéØ">
    <meta property="og:description" content="Îã§Ìä∏Î°ú Í≤∞Ï†ïÏùÑ ÎÇ¥Î†§Î≥¥ÏÑ∏Ïöî!">
    <meta property="og:url" content="">
    <meta property="og:site_name" content="Í≤∞Ï†ïÏû•Ïï† Îã§Ìä∏">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:image" content="og_image.png">
    
    <!-- ÌååÎπÑÏΩò -->
    <link rel="icon" type="image/png" href="icon-512x512.png">
    <link rel="apple-touch-icon" href="icon-512x512.png">
    
    <!-- PWA Îß§ÎãàÌéòÏä§Ìä∏ -->
    <link rel="manifest" href="manifest.json">
    
    <style>
        /* ===================================== */
        /* üéØ Îã§Ìä∏ Í≤åÏûÑ Î©îÏù∏ ÌéòÏù¥ÏßÄ - ÎØ∏ÎãàÎ©ÄÎ¶¨Ï¶ò   */
        /* ===================================== */
        
        /* Í∏∞Î≥∏ Î¶¨ÏÖã */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: white;
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* Î©îÏù∏ ÎûòÌçº - PCÏóêÏÑú ÏµúÎåÄ ÎÑàÎπÑ 480px Ï§ëÏïô Ï†ïÎ†¨ */
        .wrapper {
            max-width: 480px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Ïπ¥Ïπ¥Ïò§ÌÜ° Î∏åÎùºÏö∞Ï†Ä ÏïàÎÇ¥ */
        .kakao-notice {
            background: #fee500;
            color: #333;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            text-align: center;
            display: none;
        }
        
        .kakao-notice.show {
            display: block;
        }
        
        /* Ìó§Îçî */
        .header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            color: #007BFF;
            margin-bottom: 8px;
        }
        
        .header p {
            font-size: 1rem;
            color: #666;
        }
        
        /* ÏÑπÏÖò */
        .section {
            background-color: #f8f9fa;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid #e9ecef;
        }
        
        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* ÏûÖÎ†• ÏãúÏä§ÌÖú */
        .input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        
        input[type="text"] {
            flex: 1;
            min-width: 200px;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            color: #333;
            background-color: white;
            transition: border-color 0.2s ease;
            outline: none;
        }
        
        input[type="text"]:focus {
            border-color: #007BFF;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }
        
        input[type="text"]::placeholder {
            color: #999;
        }
        
        /* Î≤ÑÌäº ÏãúÏä§ÌÖú - ÌååÎûÄÏÉâ(#007BFF) Ìè¨Ïù∏Ìä∏ */
        .btn {
            padding: 12px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            min-width: 80px;
            text-decoration: none;
            outline: none;
            white-space: nowrap;
        }
        
        .btn:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
        }
        
        .btn:active {
            background-color: #004494;
            transform: translateY(0);
        }
        
        .btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-small {
            padding: 8px 12px;
            font-size: 0.85rem;
            min-width: 60px;
        }
        
        .btn-outline {
            background-color: white;
            color: #007BFF;
            border: 2px solid #007BFF;
        }
        
        .btn-outline:hover {
            background-color: #007BFF;
            color: white;
        }
        
        .btn-success {
            background-color: #28a745;
        }
        
        .btn-success:hover {
            background-color: #1e7e34;
        }
        
        .btn-danger {
            background-color: #dc3545;
        }
        
        .btn-danger:hover {
            background-color: #c82333;
        }
        
        /* Í≤åÏûÑ ÏãúÏûë Î≤ÑÌäº - Í∞ÄÏû• Ï§ëÏöî! */
        #start-game-btn {
            padding: 20px 40px;
            font-size: 1.3rem;
            font-weight: 700;
            min-width: 200px;
            background: linear-gradient(45deg, #007BFF, #0056b3);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 123, 255, 0.3);
            margin-top: auto;
            margin-bottom: 20px;
        }
        
        #start-game-btn:hover {
            background: linear-gradient(45deg, #0056b3, #004494);
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0, 123, 255, 0.4);
        }
        
        #start-game-btn:disabled {
            background: #6c757d;
            box-shadow: none;
            transform: none;
        }
        
        /* Ìï≠Î™© ÌÉúÍ∑∏ */
        .items-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
            min-height: 40px;
            align-content: flex-start;
        }
        
        .item-tag {
            background-color: #e3f2fd;
            color: #007BFF;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border: 1px solid #bbdefb;
            transition: all 0.2s ease;
        }
        
        .item-tag:hover {
            background-color: #bbdefb;
            transform: scale(1.02);
        }
        
        .remove-btn {
            background: #007BFF;
            border: none;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: white;
            font-size: 12px;
            font-weight: bold;
            transition: background-color 0.2s ease;
        }
        
        .remove-btn:hover {
            background: #0056b3;
        }
        
        /* Ï¶êÍ≤®Ï∞æÍ∏∞ Î™©Î°ù */
        .favorites-list {
            list-style: none;
            margin-top: 12px;
        }
        
        .favorite-item {
            background-color: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        
        .favorite-item:hover {
            background-color: #f8f9fa;
            border-color: #007BFF;
            transform: translateY(-1px);
        }
        
        .favorite-info {
            flex: 1;
        }
        
        .favorite-name {
            font-weight: 600;
            color: #007BFF;
            margin-bottom: 4px;
            font-size: 1rem;
        }
        
        .favorite-details {
            font-size: 0.8rem;
            color: #666;
        }
        
        .favorite-actions {
            display: flex;
            gap: 8px;
        }
        
        .empty-state {
            text-align: center;
            color: #999;
            font-style: italic;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            margin: 12px 0;
            border: 1px dashed #dee2e6;
        }
        
        /* Ìï≠Î™© Ïπ¥Ïö¥ÌÑ∞ */
        .item-counter {
            background-color: #007BFF;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: auto;
        }
        
        /* Í≥µÏú†ÌïòÍ∏∞ ÏÑπÏÖò */
        .share-section {
            background-color: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
            border: 1px solid #e9ecef;
        }
        
        .share-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
        }
        
        .share-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .share-btn {
            padding: 8px 16px;
            font-size: 0.9rem;
            min-width: auto;
        }
        
        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 600px) {
            .wrapper {
                padding: 16px;
            }
            
            .header {
                padding: 20px 0;
            }
            
            .header h1 {
                font-size: 1.7rem;
            }
            
            .section {
                padding: 20px;
                margin-bottom: 20px;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            input[type="text"] {
                min-width: auto;
            }
            
            .btn {
                width: 100%;
            }
            
            #start-game-btn {
                padding: 18px 32px;
                font-size: 1.2rem;
            }
            
            .favorite-item {
                flex-direction: column;
                gap: 12px;
                text-align: center;
            }
            
            .favorite-actions {
                width: 100%;
                justify-content: center;
            }
            
            .share-buttons {
                flex-direction: column;
            }
        }
        
        /* Ï†ëÍ∑ºÏÑ± */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        *:focus {
            outline: 2px solid #007BFF;
            outline-offset: 2px;
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* ÌÜ†Ïä§Ìä∏ ÏïåÎ¶º */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #007BFF;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 500;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0, 123, 255, 0.3);
            max-width: 300px;
            word-wrap: break-word;
            transform: translateX(350px);
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.success {
            background: #28a745;
        }
        
        .toast.error {
            background: #dc3545;
        }
        
        .toast.info {
            background: #17a2b8;
        }
    </style>
</head>
<body>
    <!-- Î©îÏù∏ Ïï± -->
    <div class="wrapper">
        <!-- Ïπ¥Ïπ¥Ïò§ÌÜ° Î∏åÎùºÏö∞Ï†Ä ÏïàÎÇ¥ -->
        <div class="kakao-notice" id="kakao-notice">
            ‚ö†Ô∏è Ïπ¥Ïπ¥Ïò§ÌÜ° Î∏åÎùºÏö∞Ï†ÄÏóêÏÑúÎäî ÏùºÎ∂Ä Í∏∞Îä•Ïù¥ Ï†úÌïúÎê† Ïàò ÏûàÏäµÎãàÎã§. Ïö∞Ï∏° ÏÉÅÎã® Î©îÎâ¥ÏóêÏÑú 'Îã§Î•∏ Î∏åÎùºÏö∞Ï†ÄÎ°ú Ïó¥Í∏∞'Î•º Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.
        </div>
        
        <!-- Ìó§Îçî -->
        <header class="header">
            <h1>üéØ Í≤∞Ï†ïÏû•Ïï† Îã§Ìä∏</h1>
            <p>Îã§Ìä∏Î°ú Í≤∞Ï†ïÏùÑ ÎÇ¥Î†§Î≥¥ÏÑ∏Ïöî!</p>
        </header>
        
        <!-- Ìï≠Î™© Ï∂îÍ∞Ä ÏÑπÏÖò -->
        <section class="section">
            <h2 class="section-title">
                <span>üéØ</span>
                Îã§Ìä∏ Í≥ºÎÖÅ Ìï≠Î™©
                <span class="item-counter" id="item-counter">0Í∞ú</span>
            </h2>
            <div class="input-group">
                <input 
                    type="text" 
                    id="item-input" 
                    placeholder="ÏÑ†ÌÉùÌï† Ìï≠Î™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: ÏπòÌÇ®, ÌîºÏûê, ÌñÑÎ≤ÑÍ±∞)"
                    maxlength="20"
                    aria-label="Îã§Ìä∏ Í≥ºÎÖÅÏóê Ï∂îÍ∞ÄÌï† Ìï≠Î™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                >
                <button type="button" class="btn" id="add-btn">
                    <span>‚ûï</span>
                    Ï∂îÍ∞Ä
                </button>
            </div>
            <div class="items-container" id="items-container">
                <div class="empty-state">ÏïÑÏßÅ Ï∂îÍ∞ÄÎêú Ìï≠Î™©Ïù¥ ÏóÜÏäµÎãàÎã§. ÏúÑÏóêÏÑú Ìï≠Î™©ÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!</div>
            </div>
        </section>
        
        <!-- Ï¶êÍ≤®Ï∞æÍ∏∞ ÏÑπÏÖò -->
        <section class="section">
            <h2 class="section-title">
                <span>‚≠ê</span>
                Ï¶êÍ≤®Ï∞æÍ∏∞
            </h2>
            <div class="input-group">
                <input 
                    type="text" 
                    id="favorite-name-input" 
                    placeholder="Îã§Ìä∏ Í≤åÏûÑ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                    maxlength="30"
                    aria-label="Ï¶êÍ≤®Ï∞æÍ∏∞Ïóê Ï†ÄÏû•Ìï† Îã§Ìä∏ Í≤åÏûÑ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                >
                <button type="button" class="btn" id="save-favorite-btn" disabled>
                    <span>üíæ</span>
                    Ï†ÄÏû•
                </button>
            </div>
            <ul class="favorites-list" id="favorites-list">
                <div class="empty-state">Ï†ÄÏû•Îêú Ï¶êÍ≤®Ï∞æÍ∏∞Í∞Ä ÏóÜÏäµÎãàÎã§.</div>
            </ul>
        </section>
        
        <!-- Í≥µÏú†ÌïòÍ∏∞ ÏÑπÏÖò -->
        <section class="share-section">
            <div class="share-title">üéØ ÏπúÍµ¨Îì§Í≥º Í≥µÏú†ÌïòÍ∏∞</div>
            <div class="share-buttons">
                <button type="button" class="btn btn-success share-btn" id="share-btn">
                    <span>üì§</span>
                    Í≥µÏú†ÌïòÍ∏∞
                </button>
                <button type="button" class="btn btn-outline share-btn" id="copy-btn">
                    <span>üìã</span>
                    ÎßÅÌÅ¨ Î≥µÏÇ¨
                </button>
            </div>
        </section>
        
        <!-- Í≤åÏûÑ ÏãúÏûë Î≤ÑÌäº -->
        <button type="button" id="start-game-btn" disabled>
            <span>üéØ</span>
            Í≤åÏûÑ ÏãúÏûë!
        </button>
    </div>

    <script>
        // ===================================== //
        // üéØ Îã§Ìä∏ Í≤åÏûÑ Î©îÏù∏ ÌéòÏù¥ÏßÄ              //
        // ===================================== //
        
        // ÏÉÅÌÉú Í¥ÄÎ¶¨
        let items = [];
        let favorites = [];
        
        // DOM ÏöîÏÜå Ï∞∏Ï°∞
        const itemInput = document.getElementById('item-input');
        const addBtn = document.getElementById('add-btn');
        const itemsContainer = document.getElementById('items-container');
        const itemCounter = document.getElementById('item-counter');
        const favoriteNameInput = document.getElementById('favorite-name-input');
        const saveFavoriteBtn = document.getElementById('save-favorite-btn');
        const favoritesList = document.getElementById('favorites-list');
        const startGameBtn = document.getElementById('start-game-btn');
        const shareBtn = document.getElementById('share-btn');
        const copyBtn = document.getElementById('copy-btn');
        const kakaoNotice = document.getElementById('kakao-notice');
        
        // ===================================== //
        // üì± Ïπ¥Ïπ¥Ïò§ÌÜ° Î∏åÎùºÏö∞Ï†Ä Í∞êÏßÄ              //
        // ===================================== //
        
        const detectKakaoBrowser = () => {
            const userAgent = navigator.userAgent;
            return userAgent.includes('KAKAOTALK');
        };
        
        // ===================================== //
        // üìù Ìï≠Î™© Í¥ÄÎ¶¨                          //
        // ===================================== //
        
        // Ìï≠Î™© Ï∂îÍ∞Ä
        const addItem = () => {
            const value = itemInput.value.trim();
            
            if (!value) {
                showToast('Ìï≠Î™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!', 'error');
                itemInput.focus();
                return;
            }
            
            if (value.length > 20) {
                showToast('Ìï≠Î™©ÏùÄ 20Ïûê Ïù¥ÌïòÎ°ú ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!', 'error');
                itemInput.focus();
                return;
            }
            
            if (items.includes(value)) {
                showToast('Ïù¥ÎØ∏ Ï∂îÍ∞ÄÎêú Ìï≠Î™©ÏûÖÎãàÎã§!', 'error');
                itemInput.focus();
                return;
            }
            
            if (items.length >= 12) {
                showToast('ÏµúÎåÄ 12Í∞úÍπåÏßÄÎßå Ï∂îÍ∞ÄÌï† Ïàò ÏûàÏäµÎãàÎã§!', 'error');
                return;
            }
            
            items.push(value);
            itemInput.value = '';
            itemInput.focus();
            
            updateItemsDisplay();
            updateStartGameButton();
            updateSaveFavoriteButton();
            
            showToast(`"${value}" Ìï≠Î™©Ïù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§!`, 'success');
        };
        
        // Ìï≠Î™© Ï†úÍ±∞
        const removeItem = (index) => {
            if (index < 0 || index >= items.length) return;
            
            const removedItem = items[index];
            items.splice(index, 1);
            
            updateItemsDisplay();
            updateStartGameButton();
            updateSaveFavoriteButton();
            
            showToast(`"${removedItem}" Ìï≠Î™©Ïù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§!`, 'info');
        };
        
        // Ìï≠Î™© Î™©Î°ù UI ÏóÖÎç∞Ïù¥Ìä∏
        const updateItemsDisplay = () => {
            itemsContainer.innerHTML = '';
            itemCounter.textContent = `${items.length}Í∞ú`;
            
            if (items.length === 0) {
                itemsContainer.innerHTML = '<div class="empty-state">ÏïÑÏßÅ Ï∂îÍ∞ÄÎêú Ìï≠Î™©Ïù¥ ÏóÜÏäµÎãàÎã§. ÏúÑÏóêÏÑú Ìï≠Î™©ÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!</div>';
                return;
            }
            
            items.forEach((item, index) => {
                const tag = document.createElement('div');
                tag.className = 'item-tag';
                
                const itemText = document.createElement('span');
                itemText.textContent = item;
                
                const removeButton = document.createElement('button');
                removeButton.className = 'remove-btn';
                removeButton.textContent = '√ó';
                removeButton.setAttribute('aria-label', `${item} ÏÇ≠Ï†ú`);
                removeButton.onclick = () => removeItem(index);
                
                tag.appendChild(itemText);
                tag.appendChild(removeButton);
                itemsContainer.appendChild(tag);
            });
        };
        
        // Í≤åÏûÑ ÏãúÏûë Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        const updateStartGameButton = () => {
            const canStart = items.length >= 2;
            startGameBtn.disabled = !canStart;
            
            if (canStart) {
                startGameBtn.innerHTML = '<span>üéØ</span> Í≤åÏûÑ ÏãúÏûë!';
            } else {
                startGameBtn.innerHTML = '<span>‚ùå</span> ÏµúÏÜå 2Í∞ú Ìï≠Î™© ÌïÑÏöî';
            }
        };
        
        // ===================================== //
        // ‚≠ê Ï¶êÍ≤®Ï∞æÍ∏∞ ÏãúÏä§ÌÖú                    //
        // ===================================== //
        
        // Ï¶êÍ≤®Ï∞æÍ∏∞ Ï†ÄÏû•
        const saveFavorite = () => {
            const name = favoriteNameInput.value.trim();
            
            if (!name) {
                showToast('Îã§Ìä∏ Í≤åÏûÑ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!', 'error');
                favoriteNameInput.focus();
                return;
            }
            
            if (name.length > 30) {
                showToast('Ïù¥Î¶ÑÏùÄ 30Ïûê Ïù¥ÌïòÎ°ú ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!', 'error');
                favoriteNameInput.focus();
                return;
            }
            
            if (items.length < 2) {
                showToast('ÏµúÏÜå 2Í∞ú Ìï≠Î™©Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§!', 'error');
                return;
            }
            
            const existingIndex = favorites.findIndex(fav => fav.name === name);
            
            if (existingIndex !== -1) {
                if (!confirm(`"${name}" Ïù¥Î¶ÑÏùò Ï¶êÍ≤®Ï∞æÍ∏∞Í∞Ä Ïù¥ÎØ∏ ÏûàÏäµÎãàÎã§. ÎçÆÏñ¥Ïì∞ÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                    return;
                }
                favorites[existingIndex] = {
                    name: name,
                    items: [...items],
                    createdAt: Date.now()
                };
            } else {
                favorites.push({
                    name: name,
                    items: [...items],
                    createdAt: Date.now()
                });
            }
            
            saveFavoritesToStorage();
            favoriteNameInput.value = '';
            updateFavoritesDisplay();
            updateSaveFavoriteButton();
            
            showToast(`"${name}" Ï¶êÍ≤®Ï∞æÍ∏∞Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!`, 'success');
        };
        
        // Ï¶êÍ≤®Ï∞æÍ∏∞ Î∂àÎü¨Ïò§Í∏∞
        const loadFavorite = (index) => {
            if (index < 0 || index >= favorites.length) return;
            
            const favorite = favorites[index];
            
            if (items.length > 0) {
                if (!confirm(`ÌòÑÏû¨ Ìï≠Î™©Îì§Ïù¥ "${favorite.name}" Ï¶êÍ≤®Ï∞æÍ∏∞Î°ú Î∞îÎÄùÎãàÎã§. Í≥ÑÏÜçÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                    return;
                }
            }
            
            items = [...favorite.items];
            
            updateItemsDisplay();
            updateStartGameButton();
            updateSaveFavoriteButton();
            
            showToast(`"${favorite.name}" Ï¶êÍ≤®Ï∞æÍ∏∞Î•º Î∂àÎü¨ÏôîÏäµÎãàÎã§!`, 'info');
        };
        
        // Ï¶êÍ≤®Ï∞æÍ∏∞ ÏÇ≠Ï†ú
        const deleteFavorite = (index) => {
            if (index < 0 || index >= favorites.length) return;
            
            const favorite = favorites[index];
            
            if (!confirm(`"${favorite.name}" Ï¶êÍ≤®Ï∞æÍ∏∞Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                return;
            }
            
            favorites.splice(index, 1);
            saveFavoritesToStorage();
            updateFavoritesDisplay();
            
            showToast(`"${favorite.name}" Ï¶êÍ≤®Ï∞æÍ∏∞Í∞Ä ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§!`, 'info');
        };
        
        // Ï¶êÍ≤®Ï∞æÍ∏∞ Î™©Î°ù UI ÏóÖÎç∞Ïù¥Ìä∏
        const updateFavoritesDisplay = () => {
            favoritesList.innerHTML = '';
            
            if (favorites.length === 0) {
                favoritesList.innerHTML = '<div class="empty-state">Ï†ÄÏû•Îêú Ï¶êÍ≤®Ï∞æÍ∏∞Í∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }
            
            favorites.forEach((favorite, index) => {
                const listItem = document.createElement('li');
                listItem.className = 'favorite-item';
                
                const info = document.createElement('div');
                info.className = 'favorite-info';
                
                const name = document.createElement('div');
                name.className = 'favorite-name';
                name.textContent = favorite.name;
                
                const details = document.createElement('div');
                details.className = 'favorite-details';
                const date = new Date(favorite.createdAt).toLocaleDateString();
                details.textContent = `${favorite.items.length}Í∞ú Ìï≠Î™© ‚Ä¢ ${date}`;
                
                info.appendChild(name);
                info.appendChild(details);
                
                const actions = document.createElement('div');
                actions.className = 'favorite-actions';
                
                const loadBtn = document.createElement('button');
                loadBtn.className = 'btn btn-small';
                loadBtn.innerHTML = '<span>üìÇ</span> Î∂àÎü¨Ïò§Í∏∞';
                loadBtn.onclick = () => loadFavorite(index);
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn btn-small btn-outline';
                deleteBtn.innerHTML = '<span>üóëÔ∏è</span> ÏÇ≠Ï†ú';
                deleteBtn.onclick = () => deleteFavorite(index);
                
                actions.appendChild(loadBtn);
                actions.appendChild(deleteBtn);
                
                listItem.appendChild(info);
                listItem.appendChild(actions);
                favoritesList.appendChild(listItem);
            });
        };
        
        // Ï†ÄÏû• Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        const updateSaveFavoriteButton = () => {
            const hasItems = items.length >= 2;
            const hasName = favoriteNameInput.value.trim().length > 0;
            
            saveFavoriteBtn.disabled = !hasItems || !hasName;
        };
        
        // localStorage Í¥ÄÎ¶¨
        const saveFavoritesToStorage = () => {
            try {
                localStorage.setItem('dart-favorites', JSON.stringify(favorites));
            } catch (error) {
                console.error('Ï¶êÍ≤®Ï∞æÍ∏∞ Ï†ÄÏû• Ïã§Ìå®:', error);
                showToast('Ï†ÄÏû• Í≥µÍ∞ÑÏù¥ Î∂ÄÏ°±Ìï©ÎãàÎã§!', 'error');
            }
        };
        
        const loadFavoritesFromStorage = () => {
            try {
                const saved = localStorage.getItem('dart-favorites');
                if (saved) {
                    favorites = JSON.parse(saved);
                    updateFavoritesDisplay();
                }
            } catch (error) {
                console.error('Ï¶êÍ≤®Ï∞æÍ∏∞ Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®:', error);
                favorites = [];
            }
        };
        
        // ===================================== //
        // üéØ Í≤åÏûÑ ÏãúÏûë Î≤ÑÌäº - URL ÌååÎùºÎØ∏ÌÑ∞ Ï†ÑÎã¨ //
        // ===================================== //
        
        // Í≤åÏûÑ ÏãúÏûë Î≤ÑÌäº ÌÅ¥Î¶≠ Ï≤òÎ¶¨ (URL ÌååÎùºÎØ∏ÌÑ∞ Î∞©Ïãù)
        const handleStartGame = () => {
            if (items.length < 2) {
                showToast('ÏµúÏÜå 2Í∞ú Ìï≠Î™©Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§!', 'error');
                return;
            }
            
            try {
                // items Î∞∞Ïó¥ÏùÑ URL ÌååÎùºÎØ∏ÌÑ∞Î°ú Î≥ÄÌôò (ÌïúÍ∏Ä Íπ®Ïßê Î∞©ÏßÄ)
                const encodedItems = items.map(item => encodeURIComponent(item)).join(',');
                const targetUrl = `game.html?items=${encodedItems}`;
                
                console.log('üéØ Ï†ÑÎã¨Ìï† Ìï≠Î™©Îì§:', items);
                console.log('üì¶ URL ÌååÎùºÎØ∏ÌÑ∞:', encodedItems);
                console.log('üöÄ Ïù¥ÎèôÌï† Ï£ºÏÜå:', targetUrl);
                
                // game.html ÌéòÏù¥ÏßÄÎ°ú Ïù¥Îèô
                window.location.href = targetUrl;
                
            } catch (error) {
                console.error('URL ÏÉùÏÑ± Ïã§Ìå®:', error);
                showToast('Í≤åÏûÑ ÏãúÏûëÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.', 'error');
            }
        };
        
        // ===================================== //
        // üì§ Í≥µÏú†ÌïòÍ∏∞ Í∏∞Îä•                      //
        // ===================================== //
        
        // Í≥µÏú†ÌïòÍ∏∞ Î≤ÑÌäº
        const handleShare = async () => {
            const shareData = {
                title: 'Í≤∞Ï†ïÏû•Ïï† Îã§Ìä∏ üéØ',
                text: 'Îã§Ìä∏Î°ú Í≤∞Ï†ïÏùÑ ÎÇ¥Î†§Î≥¥ÏÑ∏Ïöî!',
                url: window.location.href
            };
            
            if (navigator.share) {
                try {
                    await navigator.share(shareData);
                    showToast('Í≥µÏú†Í∞Ä ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!', 'success');
                } catch (error) {
                    if (error.name !== 'AbortError') {
                        console.error('Í≥µÏú† Ïã§Ìå®:', error);
                        fallbackShare();
                    }
                }
            } else {
                fallbackShare();
            }
        };
        
        // ÎßÅÌÅ¨ Î≥µÏÇ¨
        const handleCopyLink = async () => {
            try {
                await navigator.clipboard.writeText(window.location.href);
                showToast('ÎßÅÌÅ¨Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!', 'success');
            } catch (error) {
                console.error('ÎßÅÌÅ¨ Î≥µÏÇ¨ Ïã§Ìå®:', error);
                showToast('ÎßÅÌÅ¨ Î≥µÏÇ¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.', 'error');
            }
        };
        
        // Í≥µÏú† ÎåÄÏ≤¥ Î∞©Î≤ï
        const fallbackShare = () => {
            const text = `Îã§Ìä∏Î°ú Í≤∞Ï†ïÏùÑ ÎÇ¥Î†§Î≥¥ÏÑ∏Ïöî! ${window.location.href}`;
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    showToast('Í≥µÏú† ÌÖçÏä§Ìä∏Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!', 'success');
                });
            } else {
                showToast('Í≥µÏú† Í∏∞Îä•ÏùÑ ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.', 'error');
            }
        };
        
        // ===================================== //
        // üîî ÏïåÎ¶º ÏãúÏä§ÌÖú                        //
        // ===================================== //
        
        // ÌÜ†Ïä§Ìä∏ ÏïåÎ¶º
        const showToast = (message, type = 'info') => {
            const existing = document.querySelector('.toast');
            if (existing) {
                existing.remove();
            }
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentElement) {
                        toast.remove();
                    }
                }, 300);
            }, 3000);
        };
        
        // ===================================== //
        // üéÆ Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Î∞è Ï¥àÍ∏∞Ìôî            //
        // ===================================== //
        
        // ÌÇ§Î≥¥Îìú Ïù¥Î≤§Ìä∏
        const handleKeyPress = (event) => {
            if (event.key === 'Enter') {
                event.preventDefault();
                if (event.target === itemInput) {
                    addItem();
                } else if (event.target === favoriteNameInput) {
                    if (!saveFavoriteBtn.disabled) {
                        saveFavorite();
                    }
                }
            }
        };
        
        // Ï†ÑÏó≠ ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
        const handleGlobalKeyDown = (event) => {
            if ((event.ctrlKey || event.metaKey) && event.key === 'Enter') {
                event.preventDefault();
                if (!startGameBtn.disabled) {
                    handleStartGame();
                }
            }
        };
        
        // Ï¥àÍ∏∞Ìôî Ìï®Ïàò
        const init = () => {
            // Ïπ¥Ïπ¥Ïò§ÌÜ° Î∏åÎùºÏö∞Ï†Ä Í∞êÏßÄ
            if (detectKakaoBrowser()) {
                kakaoNotice.classList.add('show');
            }
            
            // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
            addBtn.addEventListener('click', addItem);
            startGameBtn.addEventListener('click', handleStartGame);
            saveFavoriteBtn.addEventListener('click', saveFavorite);
            shareBtn.addEventListener('click', handleShare);
            copyBtn.addEventListener('click', handleCopyLink);
            itemInput.addEventListener('keypress', handleKeyPress);
            favoriteNameInput.addEventListener('keypress', handleKeyPress);
            favoriteNameInput.addEventListener('input', updateSaveFavoriteButton);
            document.addEventListener('keydown', handleGlobalKeyDown);
            
            // Ï†ÄÏû•Îêú Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞
            loadFavoritesFromStorage();
            
            // Ï¥àÍ∏∞ UI ÏÑ§Ï†ï
            updateItemsDisplay();
            updateFavoritesDisplay();
            updateStartGameButton();
            updateSaveFavoriteButton();
            
            // Ï¥àÍ∏∞ Ìè¨Ïª§Ïä§
            if (window.innerWidth > 600) {
                itemInput.focus();
            }
            
            console.log('üéØ Îã§Ìä∏ Í≤åÏûÑ Î©îÏù∏ ÌéòÏù¥ÏßÄ Ï¥àÍ∏∞Ìôî ÏôÑÎ£å!');
            console.log('üì¶ URL ÌååÎùºÎØ∏ÌÑ∞ Ï†ÑÎã¨ Î∞©Ïãù: game.html');
        };
        
        // DOM Î°úÎìú ÏôÑÎ£å ÌõÑ Ï¥àÍ∏∞Ìôî
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
        
        console.log('üé® Îã§Ìä∏ Í≤åÏûÑ Î©îÏù∏ ÌéòÏù¥ÏßÄ Î°úÎìú ÏôÑÎ£å');
    </script>
    
    <!-- PWA Service Worker Îì±Î°ù -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then((registration) => {
                        console.log('‚úÖ Service Worker Îì±Î°ù ÏÑ±Í≥µ:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('‚ùå Service Worker Îì±Î°ù Ïã§Ìå®:', error);
                    });
            });
        }

        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('üì± PWA ÏÑ§Ïπò Í∞ÄÎä•');
        });

        window.addEventListener('appinstalled', () => {
            console.log('üéâ PWA ÏÑ§Ïπò ÏôÑÎ£å!');
            deferredPrompt = null;
        });
    </script>
</body>
</html>